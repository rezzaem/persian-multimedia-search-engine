<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chatbot</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }

    #chat-container {
      border: 1px solid #ccc;
      padding: 10px;
    }

    #chat-history {
      height: 300px;
      overflow-y: scroll;
      border: 1px solid #ccc;
      padding: 10px;
    }

    #input-container {
      display: flex;
      margin-top: 10px;
    }

    #chat-input {
      flex-grow: 1;
      padding: 5px;
    }

    #send-btn {
      margin-left: 10px;
    }
  </style>
</head>
<body>
  <h1>Chatbot</h1>
  <div id="chat-container">
    <div id="chat-history"></div>
    <div id="input-container">
      <input type="text" id="chat-input" placeholder="Type your message...">
      <button id="send-btn">Send</button>
    </div>
  </div>

  <script>
const chatHistory = document.getElementById('chat-history');
const chatInput = document.getElementById('chat-input');
const sendBtn = document.getElementById('send-btn');

sendBtn.addEventListener('click', handleUserInput);

function handleUserInput() {
  const userInput = chatInput.value.trim();
  if (userInput === '') return;

  const userBubble = createChatBubble('user', userInput);
  chatHistory.appendChild(userBubble);
  chatInput.value = '';

  fetchChatbotResponse(userInput)
    .then(response => {
      const chatBubble = createChatBubble('bot', response);
      chatHistory.appendChild(chatBubble);
    })
    .catch(error => {
      console.error('Error fetching chatbot response:', error);
    });
}

function fetchChatbotResponse(userInput) {
  const options = {
    method: 'POST',
    headers: {
      'accept': 'application/json',
      'content-type': 'application/json',
      'authorization': 'Bearer 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'
    },
    body: JSON.stringify({
      model: 'mistral-7b-instruct',
      messages: [
        { role: 'system', content: 'Respond in the format: [{Main title of the chat or problem},{Answer to the problem}]' },
        { role: 'user', content: userInput }
      ]
    })
  };

  return fetch('https://api.perplexity.ai/chat/completions', options)
    .then(response => response.json())
    .then(data => data.result.response.content)
    .catch(err => console.error(err));
}

function createChatBubble(role, content) {
  const chatBubble = document.createElement('div');
  chatBubble.classList.add('chat-bubble', role);
  chatBubble.textContent = content;
  return chatBubble;
}
  </script>
</body>
</html>